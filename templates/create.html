{% extends 'base.html' %}

{% block content %}
<h1>{% block title %} Add a New Message {% endblock %}</h1>
<link rel="stylesheet" href="/path/to/styles/default.min.css">
<script src="/path/to/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
<script>
	// Get the input field
	var input = document.getElementById("search");

	// Execute a function when the user presses a key on the keyboard
	input.addEventListener("keypress", function(event) {
			// If the user presses the "Enter" key on the keyboard
			if (event.key === "Enter") {
					// Cancel the default action, if needed
					event.preventDefault();
					// Trigger the button element with a click
					document.getElementById("submit").click();
				}
		});
	async function userAction() {
			const response = await fetch('https://votewatch.ch/search?q=' + encodeURIComponent(document.getElementById('search').value));
			const myJson = await response.json(); //extract JSON from the http response
			document.getElementById('result').textContent = JSON.stringify(myJson);
			// document.getElementById('result').innerHTML = hljs.highlight(JSON.stringify(myJson), {language: 'json'}).value
			// console.log(myJson);
		}
</script>
<!--form method="post"-->
<label for="title">Title</label>
<br>
<input id="search" type="text" name="title"
			       placeholder="Message title"
			       value="{{ request.form['title'] }}"></input>
<button id="submit" type="submit" onclick="userAction()">Submit</button>
<br>
<label>Result</label>
<div id="result">
</div>
<!--/form-->
{% endblock %}
